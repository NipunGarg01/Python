import re
import pprint
import time

'''
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
+                                                  BFD SESSIONS                                                   +
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|Index|    Session Name                               | Type |Configured |Negotiated |Admin|Oper | Down | Current |
|     |                                               |      |Intvl(ms)  |Intvl(ms)  |State|State| Count| Up Time |
|     |                                               |      |  Tx | Rx  |  Tx | Rx  |     |     |      |DD:HH:MM |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|1    |ip1_8_2                                        |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:1:7    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|2    |ip1_8(_3)                                      |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:1:3    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|3    |ip1_7_2#$&{}?*                                 |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:1:3    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|5    |LBFS_19_00CA01_co@&-7_8_2501VC1#@              |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:1:7    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|6    |LBFS_19_80CA41_co}-7_{8_2501VC1_backup         |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:1:2    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|2    |ipBfdSession_@12.100.1.1                       |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:3:16   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|12   |bgpIpBfdMHSess_1.1.1.1                         |IP :MH|10   |10   |-    |-    |Ena  |Down |0     |0        |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
'''
start = time.time()
sample = '''
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
+                                                  BFD SESSIONS                                                   +
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|Index|    Session Name                               | Type |Configured |Negotiated |Admin|Oper | Down | Current |
|     |                                               |      |Intvl(ms)  |Intvl(ms)  |State|State| Count| Up Time |
|     |                                               |      |  Tx | Rx  |  Tx | Rx  |     |     |      |DD:HH:MM |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|1    |LBFS_19_003601_NE-4_NE-5-CO1                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|2    |LBFS_19_003701_NE-4_NE-5-CO2                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|3    |LBFS_19_003801_NE-4_NE-5-CO3                   |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|4    |LBFS_19_003901_NE-4_NE-5-CO4                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|5    |LBFS_19_003A01_NE-4_NE-5-CO5                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|6    |LBFS_19_003B01_NE-4_NE-5-CO6                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|7    |LBFS_19_003C01_NE-4_NE-5-CO7                   |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|8    |LBFS_19_003D01_NE-4_NE-5-CO8                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|9    |LBFS_19_003E01_NE-4_NE-5-CO9                   |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|10   |LBFS_19_003F01_NE-4_NE-5-CO10                  |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|11   |LBFS_19_004001_NE-4_NE-5-CO11                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|12   |LBFS_19_004101_NE-4_NE-5-CO12                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|13   |LBFS_19_004201_NE-4_NE-5-CO13                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|14   |LBFS_19_004301_NE-4_NE-5-CO14                  |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|15   |LBFS_19_004401_NE-4_NE-5-CO15                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|16   |LBFS_19_004501_NE-4_NE-5-CO16                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|17   |LBFS_19_004601_NE-4_NE-5-CO17                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|18   |LBFS_19_004701_NE-4_NE-5-CO18                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|19   |LBFS_19_004801_NE-4_NE-5-CO19                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|20   |LBFS_19_004901_NE-4_NE-5-CO20                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|21   |LBFS_19_004A01_NE-4_NE-5-CO21                  |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|22   |LBFS_19_004B01_NE-4_NE-5-CO22                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|23   |LBFS_19_004C01_NE-4_NE-5-CO23                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|24   |LBFS_19_004D01_NE-4_NE-5-CO24                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|25   |LBFS_19_004E01_NE-4_NE-5-CO25                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|26   |LBFS_19_004F01_NE-4_NE-5-CO26                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|27   |LBFS_19_005001_NE-4_NE-5-CO27                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|28   |LBFS_19_005101_NE-4_NE-5-CO28                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|29   |LBFS_19_005201_NE-4_NE-5-CO29                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|30   |LBFS_19_005301_NE-4_NE-5-CO30                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|31   |LBFS_19_005401_NE-4_NE-5-CO31                  |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|32   |LBFS_19_005501_NE-4_NE-5-CO32                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|33   |LBFS_19_005601_NE-4_NE-5-CO33                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|34   |LBFS_19_005701_NE-4_NE-5-CO34                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|35   |LBFS_19_005801_NE-4_NE-5-CO35                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|36   |LBFS_19_005901_NE-4_NE-5-CO36                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|37   |LBFS_19_005A01_NE-4_NE-5-CO37                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|38   |LBFS_19_005B01_NE-4_NE-5-CO38                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|39   |LBFS_19_005C01_NE-4_NE-5-CO39                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|40   |LBFS_19_005D01_NE-4_NE-5-CO40                  |LSP   |10   |10   |10   |10   |Ena  |Up   |10    |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|41   |LBFS_19_005E01_NE-4_NE-5-CO41                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|42   |LBFS_19_005F01_NE-4_NE-5-CO42                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|43   |LBFS_19_006001_NE-4_NE-5-CO43                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|44   |LBFS_19_006101_NE-4_NE-5-CO44                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|45   |LBFS_19_006201_NE-4_NE-5-CO45                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|46   |LBFS_19_006301_NE-4_NE-5-CO46                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|47   |LBFS_19_006401_NE-4_NE-5-CO47                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|48   |LBFS_19_006501_NE-4_NE-5-CO48                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|49   |LBFS_19_006601_NE-4_NE-5-CO49                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|50   |LBFS_19_006701_NE-4_NE-5-CO50                  |LSP   |10   |10   |10   |10   |Ena  |Up   |9     |0:0:0    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|51   |ipBfdSession_200.200.2.93                      |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:9:5    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|53   |ipBfdSession_200.200.2.105                     |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:9:5    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|54   |ipBfdSession_200.200.2.117                     |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:9:5    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|55   |ipBfdSession_200.200.2.101                     |IP :SH|10   |10   |10   |10   |Ena  |Up   |0     |0:9:5    |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|105  |LBFS_1B_400241_NE-5_NE-4-CO2_backup            |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|106  |LBFS_1B_400141_NE-5_NE-4-CO1_backup            |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|107  |LBFS_1B_400341_NE-5_NE-4-CO3_backup            |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|108  |LBFS_1B_401141_NE-5_NE-4-CO17_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|109  |LBFS_1B_400D41_NE-5_NE-4-CO13_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|110  |LBFS_1B_401541_NE-5_NE-4-CO21_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|111  |LBFS_1B_400441_NE-5_NE-4-CO4_backup            |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|112  |LBFS_1B_400B41_NE-5_NE-4-CO11_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|113  |LBFS_1B_401041_NE-5_NE-4-CO16_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|114  |LBFS_1B_400F41_NE-5_NE-4-CO15_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|115  |LBFS_1B_401441_NE-5_NE-4-CO20_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|116  |LBFS_1B_401F41_NE-5_NE-4-CO31_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|117  |LBFS_1B_401841_NE-5_NE-4-CO24_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|118  |LBFS_1B_401A41_NE-5_NE-4-CO26_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|119  |LBFS_1B_401241_NE-5_NE-4-CO18_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|120  |LBFS_1B_402941_NE-5_NE-4-CO41_backup           |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
|121  |LBFS_1B_400741_NE-5_NE-4-CO7_backup            |LSP   |10   |10   |10   |10   |Ena  |Up   |0     |0:0:26   |
+-----+-----------------------------------------------+------+-----------+-----------+-----+-----+------+---------+
'''

bfddict = {}
for line in sample.split('\n'):
    try:
        match = re.search(r'([\d]+)[\s|]+([\w#$&{})(?*@.-]+)[\s|]+([\w\s:]+)[|]+(\d+)[\s|]+(\d+)[\s|]+([\d-]+)[\s|]+'
                          r'([\d-]+)[\s|]+(\w+)[\s|]+(\w+)[\s|]+(\d+)[\s|]+([\d:]+)', line)
        index = match.group(1)
        session = match.group(2)
        bfdtype = match.group(3)
        if " " in bfdtype:
            bfdtype = bfdtype.replace(" ", "")

        configuredtxinterval = match.group(4)
        configuredrxinterval = match.group(5)
        negotiatedtxinterval = match.group(6)
        negotiatedrxinterval = match.group(7)
        adminstate = match.group(8)
        operstate = match.group(9)
        downcount = match.group(10)
        uptime = match.group(11)
        bfddict[session] = {}
        bfddict[session]['bfdtype'] = bfdtype
        bfddict[session]['configuredtxinterval'] = configuredtxinterval
        bfddict[session]['configuredrxinterval'] = configuredrxinterval
        bfddict[session]['negototiatedtxinterval'] = negotiatedtxinterval
        bfddict[session]['negotiatedrxinterval'] = negotiatedrxinterval
        bfddict[session]['adminstate'] = adminstate
        bfddict[session]['operstate'] = operstate
        bfddict[session]['downcount'] = downcount
        bfddict[session]['uptime'] = uptime
        bfddict[session]['index'] = index

    except Exception:
        index = None
        type = None
        configuredtxinterval = None
        configuredrxinterval = None
        negotiatedrxinterval = None
        negotiatedtxinterval = None
        adminstate = None
        operstate = None
        downcount = None
        uptime = None


#print(bfddict)

pp = pprint.PrettyPrinter(indent=4,width=10)
pp.pprint(bfddict)
count = 0
for key in bfddict:
    print(key)
    count = count +1

print(count)
end = time.time()
print(end-start)



